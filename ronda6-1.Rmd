---
title: "Regresión Líneal"
subtitle: "Diplomado de Probabilidad y Estadística Matemática en R"
author: "http://synergy.vision/"
output:
  pdf_document:
      toc: yes
      toc_depth: 4
      includes:
        in_header: ./preambulo.tex
  html_document: default
fontsize: 12pt
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(latex2exp)
library(ggplot2)
source("ggplottheme.R")
library(grid)
library('readxl')
library(gridExtra)
mod_name<-"Regresión lineal"
credits<-function(f){
  grid.arrange(f,right=textGrob(paste0(mod_name," (C) Synergy Vision - 2018"),
                                gp=gpar(fontsize=7, fontface="italic", col="gray75"),
                                rot=90, just = "centre", vjust=-2))
}
```

\newpage

# Ejercicio 1 

William Hawkins, vicepresidente de personal de la International Motors, trabaja en la relación entre el salario de un trabajador y el porcentaje de ausentismo.  Hawkins dividió el intervalo de salarios de International en 12 grados o niveles (1 es el de menor grado, 12 el más alto) y después muestreó aleatoriamente a un grupo de trabajadores.  Determinó el grado de salario de cada trabajador y el número de días que ese empleado había faltado en los últimos 3 años.

| Categoría de salario | Ausencias | Categoría de salario | Ausencias |
|:--------------------:|:---------:|:--------------------:|:---------:|
|          11          |     18    |          11          |     14    |
|          10          |     17    |           8          |     20    |
|           8          |     29    |           7          |     32    |
|           5          |     36    |           2          |     39    |
|           9          |     11    |           9          |     16    |
|           9          |     26    |           8          |     26    |
|           7          |     28    |           6          |     31    |
|           3          |     35    |           3          |     40    |

Elabore un diagrama de dispersión para estos datos e indique el tipo de relación.

\underline{\textbf{Solución:}}

Grafiquemos estos datos mediante R.

```{r,comment='',warning=FALSE}
Salario<-c(11,10,8,5,9,9,7,3,11,8,7,2,9,8,6,3)
Ausencia<-c(18,17,29,36,11,26,28,35,14,20,32,39,16,26,31,40)

Datos<-data.frame(Salario,Ausencia)

f<-ggplot(Datos,mapping = aes(x=Salario,y=Ausencia))+
  geom_point(colour='darkred')+
  labs(title = "Salarios versus Ausencias", x="Salarios", y="Ausencias",
       caption = "http://synergy.vision/" )+
  vision
credits(f)
```

La relación que se observa en la gráfica es lineal de tipo inversa.

\newpage

# Ejercicio 2

Las ventas de línea blanca varían según el estado del mercado de casas nuevas: cuando las ventas de casas nuevas son buenas, también lo son las de lavaplatos, lavadoras de ropa, secadoras y refrigeradores.  Una asociación de comercio compiló los siguientes datos históricos (en miles de unidades) de las ventas de línea blanca y la construcción de casas.

| Construcción de  casas (miles) | Ventas de línea blanca (miles) |
|:------------------------------:|:------------------------------:|
|               2.0              |               5.0              |
|               2.5              |               5.5              |
|               3.2              |               6.0              |
|               3.6              |               7.0              |
|               3.3              |               7.2              |
|               4.0              |               7.7              |
|               4.2              |               8.4              |
|               4.6              |               9.0              |
|               4.8              |               9.7              |
|               5.0              |              10.0              |

a) Desarrolle una ecuación para la relación entre las ventas de línea blanca (en miles) y la construcción de casas (en miles).

b) Interprete la pendiente de la recta de regresión.

c) Calcule e interprete el error estándar de la estimación.

d) La construcción de casas durante el año próximo puede ser mayor que el intervalo registrado; se han pronosticado estimaciones hasta de 8.0 millones de unidades. Calcule un intervalo de predicción de 90% de confianza para las ventas de línea blanca, con base en los datos anteriores y el nuevo pronóstico de construcción de casas.

\underline{\textbf{Solución:}}

Grafiquemos estos datos mediante R.

```{r,comment='',warning=FALSE}
Construccion<-c(2,2.5,3.2,3.6,3.3,4,4.2,4.6,4.8,5)
Ventas<-c(5,5.5,6,7,7.2,7.7,8.4,9,9.7,10)

Datos<-as.data.frame(cbind(Construccion,Ventas))

ggplot(Datos,mapping = aes(x=Datos$Construccion,y=Datos$Ventas))+
  geom_point(colour='darkred')+
  xlab('Construccion de casas (miles)')+
  ylab('Ventas de línea blanca (miles)')
```

a) Observamos que la relación entre la construcción de casas y las ventas de línea blanca es lineal, para ajustar una recta de regresión a estos datos en R usamos el comando `lm()`. Por lo que nos queda:

```{r,comment='',warning=FALSE}
regresion<-lm(Datos$Ventas~Datos$Construccion,Datos)
coef(regresion)
```

Por lo que la ecuación para la relación entre las ventas de línea blanca y la construcción de casas es:

$$Y=1.16+1.71X$$

\newpage

b) Cuando la construcción de casas aumenta en mil unidades, las ventas de línea blanca aumentan 1.700 unidades.

c) Para calcular el error estándar de la estimación aplicamos el comando `summary()` a la recta de regresión ajustada en el inciso a). Por lo que tenemos:

```{r,comment='',warning=FALSE}
m<-summary(regresion)
m
m$sigma
```

La desviación estándar de los puntos alrededor de la recta ajustada es cercana a 373 unidades.

d) Para pronosticar el valor de las ventas de línea blanca para un valor de 8.0 millones de unidades de la construcción de casas usamos la ecuación de la recta de regresión, esto es:

$$X=8, \quad \hat{Y}=1.16+1.71(8)=14.84$$

El intervalo de confianza al 90% para la predicción calculada es de:

$$
\begin{array}{rl}
\hat{Y} &\pm t_{\displaystyle \frac{\alpha}{2}} \times s_e \\
\vspace{3mm} \hat{Y} &\pm t_{0.05} \times s_e \\
\vspace{3mm} 14.84 &\pm 1.86 (0.3737) \\
\vspace{3mm} 14.84 &\pm 0.69
\end{array}
$$
donde $t_{\displaystyle \frac{\alpha}{2}}$ es el factor de confiabilidad con $n-2$ grados de libertad y $s_e$ la desviación estándar de los residuales.

\newpage

# Ejercicio 3

Una compañía administra a sus vendedores en capacitación una prueba de ventas antes de salir a trabajar.  La administración de la compañía está interesada en determinar la relación entre las calificaciones de la prueba y las ventas logradas por esos vendedores al final de un año de trabajo.  Se recolectaron los siguientes datos de 10 agentes de ventas que han estado en el campo un año.

| Núm. de vendedor | Calif. de la prueba (T) | Núm. de unidades vendidas (S) |
|:----------------:|:-----------------------:|:-----------------------------:|
|         1        |           2.6           |               95              |
|         2        |           3.7           |              140              |
|         3        |           2.4           |               85              |
|         4        |           4.5           |              180              |
|         5        |           2.6           |              100              |
|         6        |           5.0           |              195              |
|         7        |           2.8           |              115              |
|         8        |           3.0           |              136              |
|         9        |           4.0           |              175              |
|        10        |           3.4           |              150              |

a) Encuentre la recta de regresión de mínimos cuadrados que podría usarse para predecir las ventas a partir de las calificaciones en la prueba de capacitación.

b) ¿En cuánto se incrementa el número esperado de unidades vendidas por cada incremento de 1 punto en una calificación de la prueba?

c) Utilice la recta de regresión de mínimos cuadrados para predecir el número de unidades que vendería un capacitando que obtuvo una calificación promedio en la prueba.

\underline{\textbf{Solución:}}

Grafiquemos estos datos usando R.

```{r,comment='',warning=FALSE}
Calificaciones<-c(2.6,3.7,2.4,4.5,2.6,5,2.8,3,4,3.4)
Ventas<-c(95,140,85,180,100,195,115,136,175,150)

Datos<-as.data.frame(cbind(Calificaciones,Ventas))

ggplot(Datos,mapping = aes(x=Datos$Calificaciones,y=Datos$Ventas))+
  geom_point(colour='darkred')+
  xlab('Calificaciones de la prueba')+
  ylab('Ventas')
```

a) Para encontrar la recta de regresión de mínimos cuadrados usamos el comando `lm()` en R, por lo que tenemos:

```{r,comment='',warning=FALSE}
regresion<-lm(Datos$Ventas~Datos$Calificaciones,Datos)
coef(regresion)
```

por lo que la recta de regresión está dada por:

$$Y = -4.6 + 41.6X$$
\newpage

b) Por cada incremento de 1 punto en la calificación de la prueba, se espera un incremento de 41.6 unidades vendidas.

c) Calculemos el promedio de la califcación de la prueba mediante R. Esto es:

```{r,comment='',warning=FALSE}
media<-mean(Calificaciones)
media
```

El número de unidades que vendería un capacitando que obtuvo la media de las calificaciones de prueba es de:

$$X=3.4, \quad \hat{Y}=-4.6+41.6(3.4)=136.84$$

\newpage

# Ejercicio 4

En economía, la función de demanda de un producto a menudo se estima mediante una regresión de la cantidad vendida *(Q)* sobre el precio *(P)*. La compañía Bamsy está tratando de estimar la función de demanda para su nueva muñeca "Ma´am", y ha recabado los siguientes datos:

|   P   |  Q  |
|:-----:|:---:|
|  20.0 | 125 |
|  17.5 | 156 |
|  16.0 | 183 |
|  14.0 | 190 |
| 12.05 | 212 |
|  10.0 | 238 |
|  8.0  | 250 |
|  6.5  | 276 |

a) Grafique estos datos.

b) Calcule la recta de regresión de mínimos cuadrados.

c) Trace la recta de regresión ajustada en su gráfica del inciso a).

\underline{\textbf{Solución:}}

a) Grafiquemos estos datos usando R. Nos queda:

```{r,comment='',warning=FALSE}
Precio<-c(20,17.5,16,14,12.05,10,8,6.5)
Ventas<-c(125,156,183,190,212,238,250,276)

Datos<-as.data.frame(cbind(Precio,Ventas))

ggplot(Datos,mapping = aes(x=Datos$Precio,y=Datos$Ventas))+
  geom_point(colour='darkred')+
  xlab('Precio')+
  ylab('Cantidades vendidas')
```

b) Usando el comando `lm()` tenemos:

```{r,comment='',warning=FALSE}
regresion<-lm(Datos$Ventas~Datos$Precio,Datos)
coef(regresion)
```

Por lo que la recta de regresión de mínimos cuadrados es:

$$Y=341.26-10.57X$$

\newpage

c) Trazando la recta de regresión que se ajustó a los datos nos queda:

```{r,comment='',warning=FALSE}
ggplot(Datos,mapping = aes(x=Datos$Precio,y=Datos$Ventas))+
  geom_point(colour='darkred')+
  xlab('Precio')+
  ylab('Cantidades vendidas')+geom_smooth(method='lm',se=FALSE)
```


\newpage

# Ejercicio 5

El Bank of Lincoln está interesado en reducir el tiempo que las personas esperan para ver a su banquero personal.  También  le interesa la relación entre el tiempo de espera *(Y)* en minutos y el número de banqueros atendiendo *(X)*.  Los clientes se seleccionaron al azar con los datos siguientes:

| X |   Y  |
|:-:|:----:|
| 2 | 12.8 |
| 3 | 11.3 |
| 5 |  3.2 |
| 4 |  6.4 |
| 2 | 11.6 |
| 6 |  3.2 |
| 1 |  8.7 |
| 3 | 10.5 |
| 4 |  8.2 |
| 3 | 11.3 |
| 3 |  9.4 |
| 2 | 12.8 |
| 4 |  8.2 |

a) Calcule la ecuación de regresión que mejor se ajusta a estos datos.

b) Calcule el coeficiente de determinación de la muestra y el coeficiente de correlación de muestra.

\underline{\textbf{Solución:}}

Graficando estos datos tenemos:

```{r,comment='',warning=FALSE}
X<-c(2,3,5,4,2,6,1,3,4,3,3,2,4)
Y<-c(12.8,11.3,3.2,6.4,11.6,3.2,8.7,10.5,8.2,11.3,9.4,12.8,8.2)

Datos<-as.data.frame(cbind(X,Y))

ggplot(Datos,mapping = aes(x=Datos$X,y=Datos$Y))+
  geom_point(colour='darkred')+
  xlab('Número de banqueros atendiendo')+
  ylab('Tiempo de espera (minutos)')
```

a) Usando el comando `lm()` para ajustar la ecuación de regresión nos queda:

```{r,comment='',warning=FALSE}
regresion<-lm(Datos$Y~Datos$X,Datos)
coef(regresion)
```

Por lo que la ecuación que mejor se ajusta a los datos es:

$$Y=15.26-1.92X$$

\newpage

b) Usamos el comando `summary()` para calcular el coeficiente de determinación, por lo que tenemos:

```{r,comment='',warning=FALSE}
m<-summary(regresion)
m$r.squared
```

El coeficiente de correlación está dado por la raíz cuadrada del coeficiente de determinación, esto es:

```{r,comment='',warning=FALSE}
sqrt(m$r.squared)
```


\newpage

# Ejercicio 6

Zippy Cola está estudiando el efecto de su última campaña publicitaria.  Se escogieron personas al azar y se les llamó para preguntarles cuántas latas de Zippy Cola habían comprado la semana anterior y cuántos anuncios de Zippy Cola habían leído o visto durante el mismo periodo.

| X (número de anuncios) | Y (latas compradas) |
|:----------------------:|:-------------------:|
|            3           |          11         |
|            7           |          18         |
|            4           |          9          |
|            2           |          4          |
|            0           |          7          |
|            4           |          6          |
|            1           |          3          |
|            2           |          8          |

a) Desarrolle la ecuación de estimación que mejor ajuste los datos.

b) Calcule el coeficiente de determinación de la muestra y el coeficiente de correlación.

\underline{\textbf{Solución:}}

Graficando los datos mediante R tenemos:

```{r,comment='',warning=FALSE}
Anuncios<-c(3,7,4,2,0,4,1,2)
Ventas<-c(11,18,9,4,7,6,3,8)

Datos<-as.data.frame(cbind(Anuncios,Ventas))

ggplot(Datos,mapping = aes(x=Datos$Anuncios,y=Datos$Ventas))+
  geom_point(colour='darkred')+
  xlab('Número de anuncios')+
  ylab('Número de latas compradas')
```

a) Usando el comando `lm()` en R nos queda:

```{r,comment='',warning=FALSE}
regresion<-lm(Datos$Ventas~Datos$Anuncios,Datos)
coef(regresion)
```

Así, la ecuación de regresión está dada por:

$$Y=3.33+1.71X$$

\newpage

b) Con el comando `summary()` en R obtenemos el coeficiente de determinación, esto es:

```{r,comment='',warning=FALSE}
m<-summary(regresion)
m$r.squared
```

El coeficiente de correlación es la raíz cuadrada del coeficiente de determinación, por lo que tenemos:

```{r,comment='',warning=FALSE}
sqrt(m$r.squared)
```

\newpage

# Ejercicio 7

En finanzas, es de interés observar la relación entre *Y*, el rendimiento promedio de las acciones, y *X*, el rendimiento global del mercado.  El coeficiente de la pendiente calculada por una regresión lineal se conoce como la *beta* de las acciones por los analistas de inversiones.  Una beta mayor que 1 indica que la acción es relativamente sensible a cambios en el mercado, mientras que una beta menor que 1 indica que la acción es relativamente insensible.  Para los datos siguientes, calcule la beta y pruebe si ésta es significativamente menor que 1. Use $\alpha=0.05.$

| Y (%) | X (%) |
|:-----:|:-----:|
|   10  |   11  |
|   12  |   15  |
|   8   |   3   |
|   15  |   18  |
|   9   |   10  |
|   11  |   12  |
|   8   |   6   |
|   10  |   7   |
|   13  |   18  |
|   11  |   13  |

\underline{\textbf{Solución:}}

Graficando los datos tenemos:

```{r,comment='',warning=FALSE}
X<-c(11,15,3,18,10,12,6,7,18,13)
Y<-c(10,12,8,15,9,11,8,10,13,11)

Datos<-as.data.frame(cbind(X,Y))

ggplot(Datos,mapping = aes(x=Datos$X,y=Datos$Y))+
  geom_point(colour='darkred')+
  xlab('Rendimiento global del mercado')+
  ylab('Rendimiento promedio de las acciones')
```

ajustando un modelo de regresión a estos datos nos queda:

```{r,comment='',warning=FALSE}
regresion<-lm(Datos$Y~Datos$X,Datos)
coef(regresion)
```

Por lo que el coeficiente de la pendiente de regresión conocida como la $beta$ por los inversionistas es de 0.41. Probemos si este valor es significativamente menor que 1, establecemos la siguiente hipótesis

$$
\begin{array}{rl}
H_o: B \geq 1 \\
H_a: B < 1
\end{array}
$$
donde $H_o$ es la hipótesis nula y $H_a$ es la hipótesis alternativa. El estadístico de prueba (de una cola) viene dado por:

$$t=\displaystyle \frac{b-B_{H_o}}{s_b}$$
donde,

$b$ = pendiente de la regresión ajustada

$B_{h_o}$= pendiente hipótetica

$s_b$ = error estándar del coeficiente de regresión $\left(s_b=\displaystyle \frac{s_e}{\sqrt{\Sigma X^2 - n\overline{X}^2}}\right)$

El error estándar $s_b$ lo calculamos de la siguiente manera:

```{r,comment='',warning=FALSE}
m<-summary(regresion)
se<-m$sigma
xsquared<-sum(X^2)
n<-10
mediasquared<-mean(X)^2
sb<-se/sqrt(xsquared-n*mediasquared)
sb
```

sustituyendo estos valores en el estadístico y sabiendo que $t_{0.05}$ = -1.869 (con $n-2$ grados de libertad) tenemos:

$$
\begin{array}{rl}
\vspace{3mm} t &= \displaystyle \frac{0.41-1}{0.059}\\
\vspace{3mm} &= -10
\end{array}
$$

como el valor crítico es de -1.869, tenemos que -10<-1.869 por lo que hay suficiente evidencia estadística para rechazar la hipótesis nula, por lo que el coeficiente de regresión es significativamente menor a 1, lo que implica que la $beta$ indica que las acciones son relativamente insensibles.

\newpage

# Ejercicio 8

Ned´s Beds está considerando contratar a una compañía de publicidad para estimular el negocio.  Fred, el hermano de Ned, investigó el campo de la publicidad de camas y recolectó los siguientes datos de la cantidad de ganancias *(Y)* que logra una compañía de camas y la cantidad gastada en publicidad *(X)*.  Si Fred calcula la ecuación de regresión, la pendiente de la recta indicará el incremento en la ganancia por dólar gastado en publicidad.  Ned hará la publicidad sólo si la ganancia de cada \$1 invertido excede \$1.50.  Calcule la pendiente de la ecuación de regresión y pruebe si es mayor que 1.50.  Para un nivel de significancia de 0.05, ¿debe Ned hacer la publicidad?

| Cantidades de   publicidad (X), en cientos de dólares | Ganancia (Y), en cientos de dólares | Cantidad de  publicidad (X), en cientos de dólares | Ganancia (Y), en cientos de dólares |
|:-----------------------------------------------------:|:-----------------------------------:|:--------------------------------------------------:|:-----------------------------------:|
|                          3.6                          |                12.13                |                        14.6                        |                 33.6                |
|                          4.8                          |                 14.7                |                        18.2                        |                 40.8                |
|                          9.7                          |                22.83                |                         3.7                        |                 9.4                 |
|                          12.6                         |                 28.4                |                         9.8                        |                24.84                |
|                          11.5                         |                28.33                |                        12.4                        |                30.17                |
|                          10.9                         |                27.05                |                        16.9                        |                 34.7                |


\underline{\textbf{Solución:}}

Grafiquemos estos datos mediante R, nos queda:

```{r,comment='',warning=FALSE}
Publicidad<-c(3.6,4.8,9.7,12.6,11.5,10.9,14.6,18.2,3.7,9.8,12.4,16.9)
Ganancia<-c(12.13,14.7,22.83,28.4,28.33,27.05,33.6,40.8,9.4,24.84,30.17,34.7)

Datos<-as.data.frame(cbind(Publicidad,Ganancia))

ggplot(Datos,mapping = aes(x=Datos$Publicidad,y=Datos$Ganancia))+
  geom_point(colour='darkred')+
  xlab('Cantidad gastada en publicidad')+
  ylab('Cantidad de ganancias')
```

usando el comando `lm()` tenemos:

```{r,comment='',warning=FALSE}
regresion<-lm(Datos$Ganancia~Datos$Publicidad,Datos)
coef(regresion)
```

por lo que el coeficiente de la pendiente de la recta de regresión es 1.95. Probemos si este valor es significativamente mayor que 1.50, establecemos la siguiente hipótesis

$$
\begin{array}{rl}
H_o: B \leq 1.50 \\
H_a: B > 1.50
\end{array}
$$
donde $H_o$ es la hipótesis nula y $H_a$ es la hipótesis alternativa. El estadístico de prueba (de una cola) viene dado por:

$$t=\displaystyle \frac{b-B_{H_o}}{s_b}$$

donde,

$b$ = pendiente de la regresión ajustada.

$B_{h_o}$= pendiente hipótetica.

$s_b$ = error estándar del coeficiente de regresión.

El error estándar $s_b$ viene dado por:

```{r,comment='',warning=FALSE}
m<-summary(regresion)
se<-m$sigma
xsquared<-sum(Publicidad^2)
n<-12
mediasquared<-mean(Publicidad)^2
sb<-se/sqrt(xsquared-n*mediasquared)
sb
```

sustituyendo estos valores en el estadístico y sabiendo que $t_{0.05}$ = 1.812 (con $n-2$ grados de libertad) tenemos:

$$
\begin{array}{rl}
\vspace{3mm} t &= \displaystyle \frac{1.95-1.50}{0.09}\\
\vspace{3mm} &= 5
\end{array}
$$
como el valor crítico es de 1.812, tenemos que 5>1.812 por lo que hay suficiente evidencia estadística para rechazar la hipótesis nula, por lo que el coeficiente de regresión es significativamente mayor a 1.50, lo que sugiere que Ned debería contratar a la compañía de publicidad.

\newpage

# Ejercicio 9

Un corredor de una empresa de inversión local ha estudiado la relación entre el incremento en el precio del oro *(X)* y las peticiones de sus clientes de liquidar las acciones *(Y)*.  Del conjunto de datos basado en 15 observaciones, se encontró que la pendiente de la muestra era 2.9.  Si el error estándar del coeficiente de la pendiente de regresión es 0.18, ¿existe una razón para pensar (a 0.05 de nivel de significancia) que la pendiente cambió de su valor anterior de 3.2?

\underline{\textbf{Solución:}}

Veamos si el valor de la pendiente obtenida cambió significativamente su valor anterior de 3.2, establecemos la siguiente hipótesis:

$$
\begin{array}{rl}
H_o: B = 3.2 \\
H_a: B \neq 3.2
\end{array}
$$
donde $H_o$ es la hipótesis nula y $H_a$ es la hipótesis alternativa. El estadístico de prueba (de dos colas) viene dado por:

$$t=\displaystyle \frac{b-B_{H_o}}{s_b}$$

donde,

$b$ = pendiente de la regresión ajustada.

$B_{h_o}$= pendiente hipótetica.

$s_b$ = error estándar del coeficiente de regresión.

sustituyendo los valores correspondientes en el estadístico y sabiendo que $t_{0.025}$ = $\pm$ 2.160 (con $n-2$ grados de libertad) tenemos:

$$
\begin{array}{rl}
\vspace{3mm} t &= \displaystyle \frac{2.9-3.2}{0.18}\\
\vspace{3mm} &= -1.66
\end{array}
$$
como el valor crítico es de -2.160, tenemos que -1.66 > -2.160 por lo que no hay suficiente evidencia estadística para rechazar la hipótesis nula, por lo que el coeficiente de regresión no cambió de manera significativa con respecto a su valor anterior.

\newpage

# Ejercicio 10

Los corredores de bienes raíces a menudo están interesados en ver cómo el avalúo de una casa varía de acuerdo con su tamaño.  A continuación se muestran algunos datos del área (en miles de pies cuadrados) y el avalúo (en miles de dólares) para una muestra de 11 casas.

| Área | Valor |
|:----:|:-----:|
|  1.1 |   75  |
|  1.5 |   95  |
|  1.6 |  110  |
|  1.6 |  102  |
|  1.4 |   95  |
|  1.3 |   87  |
|  1.1 |   82  |
|  1.7 |  115  |
|  1.9 |  122  |
|  1.5 |   98  |
|  1.3 |   90  |

a) Estime la regresión de mínimos cuadrados para predecir el valor según el avaluó a partir del tamaño.

b) Generalmente, los corredores de bienes raíces sienten que el valor de una casa sube 50,000 dólares por cada 1,000 pies cuadrados de área.  Para esta muestra, ¿se cumple esta relación? Utilice $\alpha=0.10.$

\underline{\textbf{Solución:}}

a) Estimemos la regresión de mínimos cuadrados como se sigue,

La primera fórmula calcula la pendiente de la recta,

$$b=\displaystyle \frac{\sum_{i=1}^nX_iY_i-n\overline{X}\overline{Y}}{\sum_{i=1}^nX_i^2-n\overline{X}^2},$$

donde,

$X=$ variable independiente.

$Y=$ variable dependiente.

$\overline{X}=$ media de $X.$

$\overline{Y}=$ media de $Y.$

$n=$ tamaño de la muestra.

La segunda fórmula calcula la ordenada de la recta,


$$a=\overline{Y}-b\overline{X.}$$

Con éstas dos ecuaciones podemos encontrar la recta que mejor se ajusta a los datos. Calculemos,


$$
\begin{array}{rl}
\vspace{3mm} b &=\displaystyle \frac{\sum_{i=1}^nX_iY_i-n\overline{X}\overline{Y}}{\sum_{i=1}^nX_i^2-n\overline{X}^2}\\
\vspace{3mm} &= \displaystyle \frac{1591.8-1557.818}{23.88-23.27}\\
\vspace{3mm} &= \displaystyle \frac{33.982}{0.61}\\
\vspace{3mm} &= 55.71
\end{array}
$$

Luego,

$$
\begin{array}{rl}
a &=\overline{Y}-b\overline{X}\\
\vspace{3mm} &= 97.36-55.71(1.45)\\
\vspace{3mm} &= 16.33
\end{array}
$$

Así, podemos sustituir éstos valores en la ecuación general de la recta,

$$Y=16.33+55.71X.$$

Utilizando ésta ecuación de estimación los corredores de bienes raices pueden ver cómo el avalúo de una casa varía de acuerdo a su tamaño. Sí, por ejemplo, se quiere estimar el valor de una casa con un área de 1.4, se tiene lo siguiente,

$$Y=16.33 + 55.71(1.4)=94.32.$$
El valor de la casa se estima en 94.32 miles de dólares.



Calculemos la recta de mínimos cuadrados usando lo siguiente en R,

```{r,comment=""}
area<-c(1.1,1.5,1.6,1.6,1.4,1.3,1.1,1.7,1.9,1.5,1.3)
valor<-c(75,95,110,102,95,87,82,115,122,98,90)

#Creando el data frame con los datos
data<-data.frame(area,valor)

#Regresión por mínimos cuadrados.
lmodel<-lm(data$valor~data$area,data)
lmodel

#Gráfica de la recta de mínimos cuadrados.
f<-ggplot(data,mapping = aes(x=area,y=valor))+
  geom_point(colour="red")+
  geom_smooth(method = "lm",fill=NA)+
  labs(title = "Regresión Lineal", x="Área", y="Valor",
       caption = "http://synergy.vision/" )+
  vision
credits(f)
```

Así, se tiene que la recta de mínimos cuadrados es:

$$y= 55.96x+15.97.$$

b) Para probar sí se cumple la relación para ésta muestra, se puede definir la siguiente prueba de hipótesis,

$$H_0: B= 50$$
$$H_a: B \ne 50$$

Donde $B$ es la relación entre el valor y el área.

Para encontrar el estadístico de prueba para $B$, es necesario primero encontrar el error estándar del coeficiente de regresión. Aquí, el coeficiente de regresión es 55.96, así el error estándar de éste coeficiente se expresa como $s_b$. $s_b$ se expresa como sigue,

$$s_b= \displaystyle \frac{s_e}{\sqrt{\sum_{i=1}^2{X_i^2}-n\overline{X}^2}}$$
Donde,

$se=$ error estándar de la estimación.

$X=$ valores de la variable independiente.

$\overline{X}=$ media de los valores de la variable independiente.

$n=$ tamaño de la muestra.

Una vez calculado $s_b$, podemos utilizar la siguiente ecuación para estandarizar la pendiente de nuestra ecuación de regresión,

$$t= \displaystyle \frac{b-B_{H_0}}{s_b},$$
en la que, 

$b=$ pendiente de la recta ajustada.

$B_{H_0}=$ pendiente real hipotética de la población.


Cómo la prueba estará basada en la distribución $t$ con $n-2$ grados de libertad, usamos $t$ para denotar la estadística estandarizada.


Hagamos los siguientes cálculos en R,

```{r,comment=""}
sumx<-sum(area^2) 
mediax<-(mean(area))^2
n<-11
b<-55.96
B<-50

s_e<-3.448 #dado por el modelo

s_b<-s_e/sqrt((sumx-n*mediax)) #error estándar del coeficiente de
#regresión
s_b

#estadístico de prueba

t<-(b-B)/s_b
t

```

Cómo la prueba es de dos colas, el $p-valor$ está dado por:

$$p-valor=2 \times P(t\geq1.35)=1.79$$
Calculando éste valor en R, tenemos lo siguiente:

```{r,comment=""}
pvalor<-pt(q=t,df=n-1)
pvalor<-2*pvalor
pvalor
```

Dado que el $p-valor$ es 1.79, para $\alpha=0.10$ se tiene,

$$p-valor=1.79\geq0.10.$$
Por lo que no hay evidencias para rechazar la hipótesis nula que el valor de una casa sube 50.000 dólares por cada 1000 pies cuadrados por área. Entonces, para ésta muestra se cumple ésta relación.

Veamos el siguiente gráfico,


```{r,echo=FALSE}
alpha <- 0.01

x<-seq(-4,4,0.01)
y<-dnorm(x,mean=0, sd=1)
cuantil1<- qnorm(1-(alpha/2))
cuantil2<- qnorm(alpha/2)

f<-ggplot(mapping = aes(x,y))+geom_line(colour = "blue")+

      geom_area(mapping = aes(x,y), fill = "blue",alpha = .2)+
      geom_area(mapping = aes(x= ifelse(x>=cuantil1,x,cuantil1),y),
                fill = "blue", alpha=0.4)+
      geom_area(mapping = aes(x= ifelse(x<=cuantil2,x,cuantil2),y), 
                fill = "blue", alpha=0.4)+
      
      geom_segment(aes(x = cuantil1, y =0 , xend = cuantil1,
                       yend = dnorm(cuantil1,mean=0, sd=1)),
                   colour = "black",linetype=2)+
      geom_segment(aes(x = cuantil2, y =0 , xend = cuantil2,
                       yend = dnorm(cuantil2,mean=0, sd=1)),
                   colour = "black",linetype=2)+
      geom_segment(aes(x = t, y =0 , xend = t, 
                       yend = dnorm(t,mean=0, sd=1)), 
                   colour = "red",linetype=1)+
      
        annotate("text", x=t, y =-0.02, label ="T", parse = TRUE)+
        annotate("text", x=cuantil1, y =-0.02, label="'T'[alpha/2]",
                 parse = TRUE)+
        annotate("text", x=cuantil2, y =-0.02, label="-'T'[alpha/2]",
                 parse = TRUE)+
        annotate("text", x=0, y = 0.1, label="'Aceptar H'[0]",
                 parse = TRUE)+
        annotate("text", x=cuantil1+0.5, y=0.05, label="'Rechazar H'[0]",
                 parse = TRUE)+
        annotate("text", x=cuantil2-0.5, y=0.05, label="'Rechazar H'[0]",
                 parse = TRUE)+
  
      ylim(-0.05,0.41)+
      xlim(-4,4)+
      labs( title = "Prueba de dos colas Distribución T",
            x = " ", y = " ",caption = "http://synergy.vision/" )+
      vision 
credits(f)
```





\newpage

# Ejercicio 11

Un gerente de operaciones está interesado en predecir los costos *C* (en miles de dólares) con base en la cantidad de materia prima de entrada *R* (en miles de libras) para un fabricante de pantalones de mezclilla.  Si la pendiente es significativamente mayor que 0.5 en los siguientes datos muestrales, entonces algo marcha mal con el proceso de producción y la maquinaria de la línea de ensamble debe ajustarse.  Al nivel de significancia de 0.05, ¿debe ajustarse la maquinaria?  Establezca explícitamente las hipótesis y una conclusión.

|  C |  R |
|:--:|:--:|
| 10 | 25 |
|  7 | 20 |
|  5 | 16 |
|  6 | 17 |
|  7 | 19 |
|  6 | 18 |

\underline{\textbf{Solución:}}

Se puede definir la siguiente prueba de hipótesis,

$$H_0: B \leq 0.5$$
$$H_a: B > 0.5$$

Donde $B$ es la relación entre el costo y la cantidad de materia prima.

Para encontrar el estadístico de prueba para $B$, es necesario primero encontrar el error estándar del coeficiente de regresión. 

El coeficiente de regresión es la pendiente de la recta que mejor se ajusta a los datos, así,

$$
\begin{array}{rl}
\vspace{3mm} b &=\displaystyle \frac{\sum_{i=1}^nX_iY_i-n\overline{X}\overline{Y}}{\sum_{i=1}^nX_i^2-n\overline{X}^2}\\
\vspace{3mm} &= \displaystyle \frac{813-785.83}{2255-2204.17}\\
\vspace{3mm} &= \displaystyle \frac{27.17}{50.83}\\
\vspace{3mm} &= 0.53
\end{array}
$$

Por lo tanto $b=0.53.$

Calculemos el coeficiente de regresión estimando la recta que mejor se ajuste a los datos en R,

```{r,comment=""}
costo<-c(10,7,5,6,7,6)
materia<-c(25,20,16,17,19,18)

#unamos éstos dos vectores.
data1<-cbind(costo,materia)

#convertimos en data frame.
data1<-data.frame(data1)

#Regresión por mínimos cuadrados.
model<-lm(data1$costo~data1$materia,data1)
model
```


Aquí, el coeficiente de regresión es 0.53, así el error estándar de éste coeficiente se expresa como $s_b$.

$$s_b= \displaystyle \frac{s_e}{\sqrt{\sum_{i=1}^n{X_i^2}-n\overline{X}^2}}$$
Donde,

$se=$ error estándar de la estimación.

$X=$ valores de la variable independiente.

$\overline{X}=$ media de los valores de la variable independiente.

$n=$ tamaño de la muestra.

Una vez calculado $s_b$, podemos utilizar la siguiente ecuación para estandarizar la pendiente de nuestra ecuación de regresión,

$$t= \displaystyle \frac{b-B_{H_0}}{s_b},$$
en la que, 

$b=$ pendiente de la recta ajustada.

$B_{H_0}=$ pendiente real hipotética de la población.


Cómo la prueba estará basada en la distribución $t$ con $n-2$ grados de libertad, usamos $t$ para denotar la estadística estandarizada.


Hagamos los siguientes cálculos en R,

```{r,comment=""}
sumx<-sum(materia^2) 
mediax<-(mean(materia))^2
n<-6
b<-0.53
B<-0.5

s_e<-0.28805 #dado por el modelo con summary(model)

s_b<-s_e/sqrt((sumx-n*mediax)) #error estándar del coeficiente de
#regresión
s_b

#estadístico de prueba

t<-(b-B)/s_b
t

```

Cómo la prueba es cola superior, el $p-valor$ está dado por:

$$p-valor= P(t\geq 0.74)=0.75$$
Calculando éste valor en R, tenemos lo siguiente:

```{r,comment=""}
pvalor<-pt(q=t,df=n-1)
pvalor
```

Dado que el $p-valor$ es 0.75, para $\alpha=0.05$ se tiene,

$$p-valor=0.75\geq0.05.$$
Por lo que no hay evidencias para rechazar la hipótesis nula, de manera que la pendiente es significativamente mayor que 0.5,entonces algo marcha mal con el proceso de producción y la maquinaria de la línea de ensamble debe ajustarse. 


Veamos el siguiente gráfico,

```{r,echo=FALSE}
alpha <- 0.05

x<-seq(-4,4,0.01)
y<-dnorm(x,mean=0, sd=1)
cuantil1<- qnorm(1-(alpha))

f<-ggplot(mapping = aes(x,y))+geom_line(colour = "blue")+

      geom_area(mapping = aes(x,y), fill = "blue",alpha = .2)+
      geom_area(mapping = aes(x= ifelse(x>=cuantil1,x,cuantil1),y),
                fill = "blue", alpha=0.4)+
      geom_segment(aes(x = cuantil1, y =0 , xend = cuantil1,
                       yend = dnorm(cuantil1,mean=0, sd=1)),
                   colour = "black",linetype=2)+
      geom_segment(aes(x = t, y =0 , xend = t, 
                       yend = dnorm(t,mean=0, sd=1)), 
                   colour = "red",linetype=1)+
      
        annotate("text", x=t, y =-0.02, label ="T", parse = TRUE)+
        annotate("text", x=cuantil1, y =-0.02, label="'T'[alpha]",
                 parse = TRUE)+
        annotate("text", x=0, y = 0.1, label="'Aceptar H'[0]",
                 parse = TRUE)+
        annotate("text", x=cuantil1+0.5, y=0.05, label="'Rechazar H'[0]",
                 parse = TRUE)+
      ylim(-0.05,0.41)+
      xlim(-4,4)+
      labs( title = "Prueba de cola superior Distribución T",
            x = " ", y = " ",caption = "http://synergy.vision/" )+
      vision 
credits(f)
```


\newpage

# Ejercicio 12

A menudo, quienes planean la comercialización deben estimar la demanda geográfica de un producto de una compañía.  La demanda no depende sólo del número de personas de una comunidad, sino también de la cantidad de dinero que tienen para gastar.  La revista *Sales & Marketing Management* utiliza los datos de censos de Estados Unidos para estimar el "ingreso de compra efectivo (ICE)" de hogares típicos estadounidenses en áreas metropolitanas del país.  El ICE es la suma de sueldos y otros ingresos, menos impuestos y multas; en resumen, es una buena medida de lo que los economistas llaman "ingreso disponible".  La cantidad total de dinero disponible para gastar en una comunidad es aproximadamente proporcional al producto del ICE por la población.

Calcule una nueva variable TD = (POB X ICE)/1,000. Calcule los coeficientes de determinación de la muestra entre VENTAS y TD. ¿Cuál de estas variables explica una parte mayor de la variación en VENTAS?

\newpage

# Ejercicio 13

Muchas compañías pequeñas compran publicidad sin analizar sus efectos.  La "guerra de las hamburguesas" (rivalidad sustancial de precios entre compañías de comida rápida) ha reducido las ganancias de Ethiopian Burguers en Santa Cruz, California, una cadena regional pequeña.  El gerente de mercadotecnia intenta demostrar que "hay que gastar dinero para ganar dinero".  Gastar en publicidad en espectaculares, en su opinión, tiene resultados directos en las ventas.  Se tienen registros de 7 meses:

| Gasto mensual en espectaculares (miles de dólares) | Rendimiento de las ventas mensuales (miles de dólares) |
|:--------------------------------------------------:|:------------------------------------------------------:|
|                         25                         |                           34                           |
|                         16                         |                           14                           |
|                         42                         |                           48                           |
|                         34                         |                           32                           |
|                         10                         |                           26                           |
|                         21                         |                           29                           |
|                         19                         |                           20                           |

a) Desarrolle la ecuación de estimación que mejor describa estos datos.

b) Calcule el error estándar de la estimación para esta relación.

c) Para un mes con gastos de \$28,000 en espectaculares, desarrolle un intervalo de confianza del 95% para las ventas mensuales esperadas ese mes.

\underline{\textbf{Solución:}}

a) Estimemos la regresión de mínimos cuadrados como se sigue,

$$
\begin{array}{rl}
\vspace{3mm} b &=\displaystyle \frac{\sum_{i=1}^nX_iY_i-n\overline{X}\overline{Y}}{\sum_{i=1}^nX_i^2-n\overline{X}^2}\\
\vspace{3mm} &= \displaystyle \frac{5427-4843}{4703-3984.14}\\
\vspace{3mm} &= \displaystyle \frac{584}{718.86}\\
\vspace{3mm} &= 0.81
\end{array}
$$
Luego,

$$
\begin{array}{rl}
a &=\overline{Y}-b\overline{X}\\
\vspace{3mm} &= 29-0.81(23.85)\\
\vspace{3mm} &= 9.68
\end{array}
$$
Así, podemos sustituir éstos valores en la ecuación general de la recta,

$$Y=9.68+0.81X.$$

Utilizando ésta ecuación de estimación el gerente de mercadotecnia puede demostrar que gastar en publicidad en espectaculares tiene resultados directos en las ventas.


Calculemos la recta de mínimos cuadrados usando lo siguiente en R,

```{r,comment=""}
library(ggplot2)
espec<-c(25,16,42,34,10,21,19)
rend<-c(34,14,48,32,26,29,20)

#unamos éstos dos vectores.
data<-cbind(espec,rend)

#convertimos en data frame.
data<-data.frame(data)

#Regresión por mínimos cuadrados.
model<-lm(data$rend~data$espec,data)
model

#Gráfica de la recta de mínimos cuadrados.

f<-ggplot(data,mapping=aes(x=espec,y=rend))+geom_point(colour="red")+
  geom_smooth(method = "lm",fill=NA)+labs(title = "Regresión Lineal",
  x="Espectaculares", y="Rendimiento",
       caption = "http://synergy.vision/" )+
  vision
credits(f)

```

Así, se tiene que la recta de mínimos cuadrados es:

$$y= 0.8124x+9.6184$$

b) El error estándar de la estimación, $s_e$, viene dado por, 
$$s_e=\displaystyle \sqrt{\frac{\sum_{i=1}^n{Y_i^2}-a\sum_{i=1}^n{Y_i}-b\sum_{i=1}^n{X_iY_i}}{n-2}},$$
donde, 

$a=$ es la ordenada de la recta ajustada.

$b=$ es la pendiente de la recta ajustada.

$n=$ tamaño de la muestra.

Así,

$$
\begin{array}{rl}
\vspace{3mm} s_e &=\displaystyle \sqrt{\frac{\sum_{i=1}^n{Y_i^2}-a\sum_{i=1}^n{Y_i}-b\sum_{i=1}^n{X_iY_i}}{n-2}}\\
\vspace{3mm} &= \displaystyle \sqrt{\frac{6597-9.62(203)-0.81(5427)}{7-2}}\\
\vspace{3mm} &= \displaystyle \sqrt{\frac{248.27}{5}}\\
\vspace{3mm} &= \displaystyle \sqrt{49.65}\\
\vspace{3mm} &=7.04
\end{array}
$$


En R, podemos hacer éste cálculo cómo sigue,

```{r,comment=""}
#El valor del error estándar es el valor del error estándar de los residuales.
summary(model)

#Calculemos s_e

s_e<-sqrt((sum(rend^2)-9.6184*sum(rend)-0.8124*sum(espec*rend))/5)
s_e
```

c) Aquí, el coeficiente de regresión es 0.8124, así el error estándar de éste coeficiente se expresa como $s_b$.

$$s_b= \displaystyle \frac{s_e}{\sqrt{\sum_{i=1}^n{X_i^2}-n\overline{X}^2}}$$
Donde,

$se=$ error estándar de la estimación.

$X=$ valores de la variable independiente.

$\overline{X}=$ media de los valores de la variable independiente.

$n=$ tamaño de la muestra.


Cómo la prueba estará basada en la distribución $t$ con $n-2$ grados de libertad, tenemos los siguientes cálculos en R,


```{r,comment=""}
sumx<-sum(espec^2) 
mediax<-(mean(espec))^2
n<-7

s_e<-sqrt((sum(rend^2)-9.6184*sum(rend)-0.8124*sum(espec*rend))/5)
s_e#dado por el modelo con summary(model)

s_b<-s_e/sqrt((sumx-n*mediax)) #error estándar del coeficiente de
#regresión
s_b

#valor crítico de t
alpha<-0.05


talpha<-qt(p=1-alpha,df=n-2)
talpha

```

Con ésta información, podemos calcular intervalos de confianza para un mes con gastos de \$28.000 en espectaculares, cómo se sigue:

$$b+t_{\alpha}(s_b)=28+2.02(0.26)=28.52$$
$$b-t_{\alpha}(s_b)=28-2.02(0.26)=19.47$$

En ésta situación, estamos 95% seguros de que las ventas para éste mes se desarrollan entre 28.52 millones de dólares y 19.47 millones de dólares.


\newpage

# Ejercicio 14

En 1992, las ventas totales de cereales para desayuno en Estados Unidos se estimaron en \$3.842 miles de millones.  Considere la siguiente información de los 10 cereales más vendidos.  Encuentre la ecuación de mínimos cuadrados que usa el precio promedio al menudeo para predecir las participaciones en el mercado. ¿Cuál de las siguientes tres generalizaciones describe mejor la relación entre estas dos variables?

a) Un precio menor incrementa las ventas.

b) Un porcentaje de mercado mayor significa que se puede cobrar un precio más alto.

c) El porcentaje de mercado no parece depender del precio.

|    Compañía   |        Cereal       | Porcentaje del mercado | Volumen (millones de dólares) | Precio promedio al menudeo |
|:-------------:|:-------------------:|:----------------------:|:-----------------------------:|:--------------------------:|
| General Mills |       Cheerios      |          4.58          |             175.96            |            $2.18           |
|   Kellogg´s   |    Frosted Flakes   |          4.08          |             156.75            |            $2.83           |
| General Mills |  Honey Nut Cheerios |          3.28          |             126.02            |            $2.99           |
|   Kellogg´s   |    Rice Krispies    |          2.99          |             114.88            |            $1.94           |
|   Kellogg´s   |     Corn Flakes     |          2.97          |             114.11            |            $1.47           |
|   Kellogg´s   |     Raisin Bran     |          2.77          |             106.42            |            $2.74           |
|   Kellogg´s   | Frosted Mini-Wheats |          2.77          |             106.42            |            $2.91           |
|   Kellogg´s   |     Froot Loops     |          2.33          |             89.52             |            $2.64           |
| General Mills |     Lucky Charms    |          1.85          |             71.08             |            $3.15           |
| General Mills |        Total        |          1.84          |             70.69             |            $2.86           |

\underline{\textbf{Solución:}}

Las variables involucradas en éste problema son Porcentaje del mercado y Precio promedio del menudeo.

Estimemos la regresión de mínimos cuadrados como se sigue,

$$
\begin{array}{rl}
\vspace{3mm} b &=\displaystyle \frac{\sum_{i=1}^nX_iY_i-n\overline{X}\overline{Y}}{\sum_{i=1}^nX_i^2-n\overline{X}^2}\\
\vspace{3mm} &= \displaystyle \frac{74.3961-75.7417}{68.6733-66.1004}\\
\vspace{3mm} &= \displaystyle \frac{-1.35}{2.57}\\
\vspace{3mm} &= -0.52
\end{array}
$$
Luego,

$$
\begin{array}{rl}
a &=\overline{Y}-b\overline{X}\\
\vspace{3mm} &= 2.95+0.52(2.57)\\
\vspace{3mm} &= 4.29
\end{array}
$$
Así, podemos sustituir éstos valores en la ecuación general de la recta,

$$Y=4.29-0.52X.$$
Utilizando ésta ecuación de estimación el gerente de mercadotecnia puede demostrar que gastar en publicidad en espectaculares tiene resultados directos en las ventas.


Calculemos la recta de mínimos cuadrados usando lo siguiente en R,

```{r,comment=""}
library(ggplot2)
menudeo<-c(2.18,2.83,2.99,1.94,1.47,2.74,2.91,2.64,3.15,2.86)
mercado<-c(4.58,4.08,3.28,2.99,2.97,2.77,2.77,2.33,1.85,1.84)

#unamos éstos dos vectores.
data<-cbind(menudeo,mercado)

#convertimos en data frame.
data<-data.frame(data)

#Regresión por mínimos cuadrados.
lmodel<-lm(data$mercado~data$menudeo,data)
lmodel

#Gráfica de la recta de mínimos cuadrados.

ggplot(data,aes(x=data$menudeo,y=data$mercado))+geom_point(colour="red")+
  geom_smooth(method = "lm",fill=NA)+xlab("Precio Promedio Menudeo")+
  ylab("Porcentaje Mercado")

```

Así, se tiene que la recta de mínimos cuadrados es:

$$y= -0.523x+4.291$$
De acuerdo a la gráfica de la recta tenemos que de la tres generalizaciones la mejor que ajusta es la relación c), es decir, el porcentaje de mercado no parece depender del precio.





\newpage

# Ejercicio 15

Dave Proffitt, estudiante de segundo año de la maestría en administración, elabora un estudio de compañías que entran a la bolsa de valores por primera vez.  Tiene curiosidad por ver si existe o no una relación significativa entre el tamaño de la oferta (en millones de dólares) y el precio por acción.

a) Dados los siguientes datos, desarrolle la ecuación de estimación que mejor ajuste los datos.

| Tamaño (millones de dólares) | Precio (dólares) |
|:----------------------------:|:----------------:|
|            108.00            |       12.00      |
|             4.40             |       4.00       |
|             3.50             |       5.00       |
|             3.60             |       6.00       |
|             39.00            |       13.00      |
|             68.40            |       19.00      |
|             7.50             |       8.50       |
|             5.50             |       5.00       |
|            375.00            |       15.00      |
|             12.00            |       6.00       |
|             51.00            |       12.00      |
|             66.00            |       12.00      |
|             10.40            |       6.50       |
|             4.00             |       3.00       |

b) Calcule el coeficiente de determinación de la muestra. ¿Debe Dave usar esta ecuación de regresión para pronosticar o debe buscar en otra parte variables explicativas adicionales?

\underline{\textbf{Solución:}}

a) Estimemos la regresión de mínimos cuadrados como se sigue,

$$
\begin{array}{rl}
\vspace{3mm} b &=\displaystyle \frac{\sum_{i=1}^nX_iY_i-n\overline{X}\overline{Y}}{\sum_{i=1}^nX_i^2-n\overline{X}^2}\\
\vspace{3mm} &= \displaystyle \frac{10431.15-6878.864}{165844.8-41072.78}\\
\vspace{3mm} &= \displaystyle \frac{3552.286}{124772}\\
\vspace{3mm} &= 0.03
\end{array}
$$

Luego,

$$
\begin{array}{rl}
a &=\overline{Y}-b\overline{X}\\
\vspace{3mm} &= 9.07-0.033(54.16)\\
\vspace{3mm} &= 7.45
\end{array}
$$

Así, podemos sustituir éstos valores en la ecuación general de la recta,

$$Y=7.45+0.03X.$$

Utilizando ésta ecuación de estimación David Proffitt puede demostrar que existe o no una relación significativa con respecto al tamaño de la oferta y el precio por acción.


Calculemos la recta de mínimos cuadrados usando lo siguiente en R,

```{r,comment=""}
library(ggplot2)
precio<-c(12,4,5,6,13,19,8.5,5,15,6,12,12,6.5,3)
tamaño<-c(108,4.4,3.5,3.6,39,68.4,7.5,5.5,375,12,51,66,10.4,4)

#unamos éstos dos vectores.
data<-cbind(precio,tamaño)

#convertimos en data frame.
data<-data.frame(data)

#Regresión por mínimos cuadrados.
lmodel<-lm(data$precio~data$tamaño,data)
lmodel

#Gráfica de la recta de mínimos cuadrados.

ggplot(data,aes(x=data$tamaño,y=data$precio))+geom_point(colour="red")+
  geom_smooth(method = "lm",fill=NA)+xlab("Tamaño")+ylab("Precio")

```

Así, se tiene que la recta de mínimos cuadrados es:

$$y= 0.03x+7.53.$$

b) El coeficiente de determinación de la muestra, $r^2$, se calcula de la siguiente forma, 

$$r^2= \displaystyle \frac{a\sum{Y}-b\sum{XY}-n\overline{Y}^2}{\sum{Y^2}-n\overline{Y}^2}$$


Sustituyendo tenemos,

$$
\begin{array}{rl}
\vspace{3mm} r^2 &= \displaystyle \frac{a\sum{Y}+b\sum{XY}-n\overline{Y}^2}{\sum{Y^2}-n\overline{Y}^2}\\
\vspace{3mm} &=  \displaystyle \frac{956.31+312.93-1152.07}{1448.5-1152.07}\\
\vspace{3mm}&= \displaystyle \frac{117.17}{296.43}\\
\vspace{3mm} &= 0.3
\end{array}
$$





En R, podemos calcular $r^2$ cómo sigue,

```{r,comment=""}
summary(lmodel)

# El coeficiente de determinación es el r^2 ajustado.
```

De acuerdo a éstos cálculos, $r^2=0.28$, es decir, la relacion entre el precio y el tamaño es muy baja, por lo tanto Dave debe considerar en otra parte variables explicativas adicionales.

\newpage

# Ejercicio 16

Se pretende describir en un modelo el comportamiento del producto interno real en Venezuela (YNR); el cual se hace depender de las siguientes variables: Gasto Fiscal interno real de período anterior (GFR); Liquidez monetaria en términos reales (LMR); exportaciones reales de petróleo e hierro (XTP) y Tasa de inflación (VCOV).  Las variables YNR, GFR, LMR, XTP están medidas en millones de bolívares.  Los datos trimestrales de las variables son los siguientes:

| Trimestre | YNR | LMR | GFR | XTP | VCOV |
|:---------:|:------:|:------:|:-----:|:-----:|:------:|
| 1974-01 | 11.840 | 19.146 | 5.165 | 3.050 | 0,055 |
| 1974-02 | 11.980 | 19.224 | 6.787 | 2.858 | 0,056 |
| 1974-03 | 12.290 | 18.952 | 3.670 | 2.950 | 0,112 |
| 1974-04 | 13.400 | 21.266 | 4.839 | 3.249 | 0,119 |
| 1975-01 | 12.990 | 22.770 | 7.029 | 2.317 | 0,121 |
| 1975-02 | 13.480 | 24.570 | 6.017 | 1.905 | 0,132 |
| 1975-03 | 14.300 | 25.363 | 3.676 | 1.845 | 0,079 |
| 1975-04 | 13.810 | 29.019 | 2.114 | 1.729 | 0,071 |
| 1976-01 | 13.930 | 28.614 | 7.779 | 1.343 | 0.069 |
| 1976-02 | 14.340 | 29.620 | 4.198 | 1.584 | 0,076 |
| 1976-03 | 15.240 | 29.655 | 4.640 | 1.704 | 0,082 |
| 1976-04 | 15.970 | 33.327 | 7.543 | 1.675 | 0,076 |
| 1977-01 | 16.360 | 33.804 | 4.220 | 2.362 | 0,084 |
| 1977-02 | 16.060 | 36.933 | 7.617 | 1.636 | 0,078 |
| 1977-03 | 15.680 | 35.666 | 5.170 | 1.802 | 0,075 |
| 1977-04 | 16.250 | 41.367 | 5.860 | 1.636 | 0,076 |
| 1978-01 | 16.410 | 38.098 | 4.139 | 1.943 | 0,075 |
| 1978-02 | 16.070 | 34.488 | 6.195 | 1.636 | 0,068 |
| 1978-03 | 17.420 | 39.250 | 5.141 | 1.595 | 0,070 |
| 1978-04 | 18.560 | 44.271 | 4.754 | 1.836 | 0,071 |
| 1979-01 | 16.760 | 39.751 | 6.236 | 2.514 | 0,076 |
| 1979-02 | 16.900 | 38.881 | 2.740 | 1.729 | 0,099 |
| 1979-03 | 16.560 | 38.796 | 4.088 | 1.846 | 0,126 |
| 1979-04 | 18.060 | 39.867 | 6.107 | 2.177 | 0,190 |
| 1980-01 | 16.840 | 37.898 | 3.435 | 2.102 | 0,218 |
| 1980-02 | 16.170 | 39.152 | 4.096 | 1.631 | 0,227 |
| 1980-03 | 17.110 | 39.019 | 4.020 | 1.513 | 0,217 |


a) Determinar la ecuación que relaciona el producto interno real con las variables explicativas.

b) Calcular el estimador de la varianza de los términos de perturbación.

c) Calcular los errores estándar de los estimadores.

d) Calcular $R$ y $R^2.$

e) Construir intervalos de confianza para los coeficientes.

f) ¿Cuál es el significado de los coeficientes y en qué unidades están medidos?

\underline{\textbf{Solución:}}

a) Calculemos la regresión múltiple usando lo siguiente en R,

```{r,comment=""}
library("readxl")
data<-read_excel("Libro1.xlsx")


#Regresión múltiple.
lmodel<-lm(data$YNR~data$LMR+data$GFR+data$XTP+data$VCOV,data)
lmodel

```

Así, se tiene que el plano que mejor se ajuste a los datos es:

$$y= 0.24x_1-0.0014x_2+0.26x_3+1471x_4+6872$$


b) y c) En R, podemos hacer éste cálculo cómo sigue,

```{r,comment=""}
#El valor del error estándar es el valor del error estándar de los residuales. 
summary(lmodel)
```

El estimador de la varianza en términos de la pertubación es el cuadrado del error estándar de la estimación. Por lo que la varianza es, $(543.1)^2=294957.6$. Así, el estimador de la varianza es 294957.6.



d) En R, podemos calcular $R^2$ cómo sigue,

```{r,comment=""}
summary(lmodel)

# El coeficiente de determinación es el R^2 ajustado.
```

El coeficiente de determinación múliple es, $R^2=0.9154$. Esto quiere decir, que las cuatro variables independientes explican el 91.5% de la variación total del producto interno real en Venezuela.

El coeficiente de correlación múltiple, $R$, es la raiz cuadrada de $R^2$. Así, $R=\sqrt{0.9154}=0.96$.

e) Construyamos un intervalo de confianza para $B_1$. (Liquidez monetaria en términos reales)

El coeficiente de regresión para éste caso es, $b_1=0.24$. El error estándar del coeficente de regresión ésta dado por $summary(lmodel)$ en R, y es $s_{b_1}=0.018$. El valor crítico de $t$ con $n-k-1$ grados de libertad ($k$ es el número de variables independientes) y un nivel de confianza de 95%, es:


```{r,comment=""}
#valor crítico de t
n<-27
k<-4
alpha<-0.05


talpha<-qt(p=1-alpha,df=n-k-1)
talpha

```

Con esta información, podemos calcular intervalos de confianza para $B_1$, como se sigue:

$$b_1+t_{\alpha}(s_{b_1})=0.24+1.72(0.018)=0.27$$
$$b_1-t_{\alpha}(s_{b_1})=0.24-1.72(0.018)=0.21$$
En esta situación, estamos 95% seguros de que la liquidez monetaria em términos reales (LMR) se desarrolla entre 0.27 millones de dólares y 0.21 millones de dólares.

Construyamos un intervalo de confianza para $B_2$. (Gasto fiscal interno real de período anterior.)

El coeficiente de regresión para éste caso es, $b_2=-0.0014$. El error estándar del coeficente de regresión ésta dado por $summary(lmodel)$ en R, y es $s_{b_2}=0.074$. El valor crítico de $t$ con $n-k-1$ grados de libertad ($k$ es el número de variables independientes) y un nivel de confianza de 95%, es 1.72.

Con esta información, podemos calcular intervalos de confianza para $B_2$, como se sigue:

$$b_2+t_{\alpha}(s_{b_2})=0.0014+1.72(0.074)=0.13$$
$$b_2-t_{\alpha}(s_{b_2})=0.0014-1.72(0.074)=-0.13$$

En esta situación, estamos 95% seguros de que el gasto fiscal interno real se desarrolla entre 0.13 millones de dólares y -0.13 millones de dólares.


Construyamos un intervalo de confianza para $B_3$. (Exportaciones reales de petróleo e hierro.)

El coeficiente de regresión para este caso es, $b_3=0.26$. El error estándar del coeficente de regresión ésta dado por $summary(lmodel)$ en R, y es $s_{b_3}=0.026$. El valor crítico de $t$ con $n-k-1$ grados de libertad ($k$ es el número de variables independientes) y un nivel de confianza de 95%, es 1.72.

Con esta información, podemos calcular intervalos de confianza para $B_3$, como se sigue:

$$b_3+t_{\alpha}(s_{b_3})=0.26+1.72(0.26)=0.71$$

$$b_3+t_{\alpha}(s_{b_3})=0.26-1.72(0.26)=-0.19$$

En esta situación, estamos 95% seguros de que las exportaciones reales de petróleo e hierro de se desarrollan entre 0.71 millones de dólares y -0.19 millones de dólares.


Construyamos un intervalo de confianza para $B_4$. (Tasa de inflación)

El coeficiente de regresión para este caso es, $b_4=1471$. El error estándar del coeficente de regresión esta dado por $summary(lmodel)$ en R, y es $s_{b_4}=2228$. El valor crítico de $t$ con $n-k-1$ grados de libertad ($k$ es el número de variables independientes) y un nivel de confianza de 95%, es 1.72.

Con esta información, podemos calcular intervalos de confianza para $B_4$, como se sigue:

$$b_4+t_{\alpha}(s_{b_4})=1471+1.72(2228)=5303.2$$
$$b_4+t_{\alpha}(s_{b_4})=1471-1.72(2228)=-2361.2$$

En esta situación, estamos 95% seguros de que la tasa de inflación se desarrolla entre 5303.2 millones de dólares y -2361.2 millones de dólares.


f) Esto quiere decir, que si se mantienen constantes las variables LMR, $X_1$, GFR, $X_2$ y XTP, $X_3$, entonces el valor $Y$ aumentará 1471 millones de bolivares por cada un millón de bolivares de inflación. Sí, se mantienen constantes las variables, $X_1,X_2$ y $X_4$, entonces el valor $Y$ aumentará 0.26 millones de bolivares por cada un millón de bolivares de exportaciones de petróleo e hierro.

\newpage

# Ejercicio 17

En un modelo econométrico se hizo depender la demanda monetaria ($Y_i$) de tres variables explicativas: nivel de ingreso privado ($X_{2i}$), exportaciones ($X_{3i}$) y gasto público ($X_{4i}$); los resultados fueron los siguientes:

$$\hat{Y_i} =-1.029+0.785X_{2i}+0.2703X_{3i}+0.2638X_{4i}$$
$$
\begin{array}{rl}
&X_{2i}=0.1641\\
&X_{3i}=0.5281\\
&X_{4i}=0.2301
\end{array}
$$
$$R^2=0.495;\quad s=0.6604;\quad F(3,31)=10.13$$

Cuando se hizo depender la demanda monetaria sólo del nivel de ingreso privado, se obtuvieron los siguientes resultados:

$$Y_i=1.839+0.8298X_{2i}$$

$$
\begin{array}{rl}
&X_{2i}=0.2503
\end{array}
$$

$$R^2=0.4725;\quad s=0.6543;\quad F(1,33)=29.56$$

a) Considerando los resultados del primer modelo. ¿Qué opina Ud. de la siguiente afirmación?.  El nivel de ingreso privado tiene influencia significativa en la demanda monetaria. $\alpha=0.05.$ 

b) Comparando los resultados de los dos modelos, ¿Qué opina Ud.  de la siguiente afirmación?: El segundo modelo es tan eficiente como el primero en la explicación de las variables de la demanda monetaria. $\alpha=0,05$.


\underline{\textbf{Solución:}}

a) Vemos que nuestra pregunta conduce a a establecer hipótesis de la forma:

$$H_0: B_{2i}= 0$$
$$H_a: B_{2i} \ne 0$$


Donde $B_{2i}$ es la relación entre el nivel de ingreso privado y la demanda monetaria.

Para encontrar el estadístico de prueba para $B_{2i}$, es necesario primero encontrar el error estándar del coeficiente de regresión, $s_{b_{2i}}$. 


Una vez calculado $s_{b_{2i}}$, podemos utilizar la siguiente ecuación para estandarizar la pendiente de nuestra ecuación de regresión,

$$t= \displaystyle \frac{b_{2i}-B_{2i_{H_0}}}{s_{b_{2i}}},$$
en la que, 

$b_{2i}=$ coeficiente de $X_{2i}$.

$B_{2i_{H_0}}=$ coeficiente hipotético $X_{2i}$.


Como la prueba estará basada en la distribución $t$ con $n-k-1$ grados de libertad, usamos $t$ para denotar la estadística estandarizada.


Hagamos los siguientes cálculos en R,

```{r,comment=""}

b2<-0.785
s_b2<-0.1641 #Dado en la hipótesis del problema X_2i=0.1641

#estadístico de prueba

t<-b2/s_b2
t

```

Entonces, como la prueba para determinar si $X_{2i}$ es una variable explicativa significativa es una prueba de dos colas, solo necesitamos verificar si $-t_c \leq t \leq t_c$, donde $t_c$ es el valor crítico de t con $n-k-1$ grados de libertad.

Calculemos el valor crítico en R,

```{r,comment=""}
#valor crítico de t
n<-35
k<-3
alpha<-0.05


talpha<-qt(p=1-alpha,df=n-k-1)
talpha
```

Como $t>t_c$, entonces hay evidencias para rechazar la hipótesis nula, por lo que aceptamos la hipótesis alternativa, de modo que concluimos que el nivel de ingreso privado tiene influencia significativa en la demanda monetaria.

b) Vemos que nuestra segunda pregunta conduce a establecer hipótesis de la forma:

$$H_0: B_{2i}= 0$$
$$H_a: B_{2i} \ne 0$$


Donde $B_{2i}$ es la relación entre el nivel de ingreso privado y la demanda monetaria.

Para encontrar el estadístico de prueba para $B_{2i}$, es necesario primero encontrar el error estándar del coeficiente de regresión, $s_{b_{2i}}$. 


Una vez calculado $s_{b_{2i}}$, podemos utilizar la siguiente ecuación para estandarizar la pendiente de nuestra ecuación de regresión,

$$t= \displaystyle \frac{b_{2i}-B_{2i_{H_0}}}{s_{b_{2i}}},$$
en la que, 

$b_{2i}=$ coeficiente de $X_{2i}$.

$B_{2i_{H_0}}=$ coeficiente hipotético $X_{2i}$.


Como la prueba estará basada en la distribución $t$ con $n-k-1$ grados de libertad, usamos $t$ para denotar la estadística estandarizada.

Hagamos los siguientes cálculos en R,

```{r,comment=""}

b2<-0.8298
s_b2<-0.2503 #Dado en la hipótesis del problema X_2i=0.2503

#estadístico de prueba

t<-b2/s_b2
t

```

Entonces, como la prueba para determinar si $X_{2i}$ es una variable explicativa significativa es una prueba de dos colas, solo necesitamos verificar si $-t_c \leq t \leq t_c$, donde $t_c$ es el valor crítico de t con $n-k-1$ grados de libertad.

Calculemos el valor crítico en R,

```{r,comment=""}
#valor crítico de t
n<-35
k<-3
alpha<-0.05


talpha<-qt(p=1-alpha,df=n-k-1)
talpha
```

Como $t>t_c$, entonces hay evidencias para rechazar la hipótesis nula, por lo que aceptamos la hipótesis alternativa, de modo que concluimos que el segundo modelo es tan eficiente como el primero en la explicación de las variables de la demanda diaria.

\newpage

# Ejercicio 18

En un modelo se analizó una función de demanda de un bien:

$$D=\beta_1+\beta_2X_2+\beta_3X_3+\beta_4X_4+\mu$$

Siendo D=Cantidades demandadas en miles de unidades; $X_2$=Ingreso per capita en miles de Bolívares; $X_3$=Indice de precios del bien (1.973=100); $X_4$=Indice de precios de un bien sustitutivo (1973=100).  Se ajustó el modelo a las observaciones anuales de las variables desde 1.973 a 1.992 y se obtuvieron los siguientes resultados:

$$\hat{D}=1.46+0.18X_2-0.37X_3+0.12X_4$$

$$
\begin{array}{rl}
&X_2=0.13\\
&X_3=0.16\\
&X_4=0.16
\end{array}
$$

$$R^2=0.69;\quad s=0.159;\quad F=11,87;\quad Y´Y=40$$

Dé su opinión acerca de las siguientes afirmaciones:

a) Un incremento unitario en el índice de precios del bien provoca, ceteris paribus, una disminución en la cantidad demandada de por lo menos 500 unidades.

b) Los precios del bien sustitutivo no tienen influencia significativa en la demanda. $\alpha=0,05.$

\underline{\textbf{Solución:}}

a) Al mantener constantes las variables $X_2$ y $X_4$, el incremento unitario de precios del bien provoca un disminución en la cantidad demandada de por lo menos 370 unidades.

b) Vemos que nuestra pregunta conduce a a establecer hipótesis de la forma:

$$H_0: B_{4i}= 0$$
$$H_a: B_{4i} \ne 0$$


Donde $B_{4i}$ es la relación entre los precios del bien sustitutivo y la demanda.

Para encontrar el estadístico de prueba para $B_{4i}$, es necesario primero encontrar el error estándar del coeficiente de regresión, $s_{b_{4i}}$. 


Una vez calculado $s_{b_{4i}}$, podemos utilizar la siguiente ecuación para estandarizar la pendiente de nuestra ecuación de regresión,

$$t= \displaystyle \frac{b_{4i}-B_{4i_{H_0}}}{s_{b_{4i}}},$$
en la que, 

$b_{4i}=$ coeficiente de $X_{4i}$.

$B_{4i_{H_0}}=$ coeficiente hipotético $X_{4i}$.


Cómo la prueba estará basada en la distribución $t$ con $n-k-1$ grados de libertad, usamos $t$ para denotar la estadística estandarizada.


Hagamos los siguientes cálculos en R,

```{r,comment=""}

b4<-0.12
s_b4<-0.16 #Dado en la hipótesis del problema X_4i=0.16

#estadístico de prueba

t<-b4/s_b4
t

```

Entonces, como la prueba para determinar si $X_{4i}$ es una variable explicativa significativa es una prueba de dos colas, solo necesitamos verificar si $-t_c \leq t \leq t_c$, donde $t_c$ es el valor crítico de t con $n-k-1$ grados de libertad.

Calculemos el valor crítico en R,

```{r,comment=""}
#valor crítico de t
n<-91
k<-3
alpha<-0.05


talpha<-qt(p=1-alpha,df=n-k-1)
talpha
```

Cómo $t<t_c$, entonces no hay evidencias para rechazar la hipótesis nula, por lo que aceptamos la hipótesis nula, de modo que concluimos que los precios del bien sustitutivo no tienen influencia significativa en la demanda.

